ติดตั้ง
composer require phpmailer/phpmailer

🔹🔹กรณีใช้ Microsoft Exchange (On-Premise ในบริษัท)
🔹ข้อมูล SMTP Server ของบริษัทคืออะไร (Host / Port / Encryption / Auth)
- Host (เช่น mail.company.local หรือ exchange.company.com)
- Port (ปกติ 587 หรือ 25)
- Encryption (STARTTLS / TLS / หรือไม่ใช้เลย)
- Username / Password (ส่วนใหญ่ใช้ account AD ของคุณ)

🔹ตัวอย่าง 1: Exchange เปิดให้ส่งผ่าน Port 25 (ไม่ต้อง Auth)
$mail = new PHPMailer(true);

$mail->isSMTP();
$mail->Host       = 'exchange.company.com';  // ชื่อ Mail Server ภายใน
$mail->Port       = 25;                      // ปกติ Exchange ภายในจะใช้ 25
$mail->SMTPAuth   = false;                   // ไม่ต้องใช้ Auth
$mail->SMTPSecure = '';                      // ไม่มี encryption

$mail->setFrom('noreply@company.com', 'ระบบอนุมัติ');
$mail->addAddress('user1@company.com');
$mail->isHTML(true);
$mail->Subject = "ทดสอบส่งเมลผ่าน Exchange";
$mail->Body    = "ข้อความจากระบบอนุมัติ (ไม่ต้องใช้ Auth)";
$mail->send();

🔹ตัวอย่าง 2: Exchange ต้อง Login ด้วย AD Account
$mail = new PHPMailer(true);

$mail->isSMTP();
$mail->Host       = 'exchange.company.com';
$mail->Port       = 587;                      // ถ้า IT เปิด TLS/STARTTLS
$mail->SMTPAuth   = true;
$mail->Username   = 'user@company.com';       // Account AD ของคุณ
$mail->Password   = 'your_password';          // รหัสผ่าน AD
$mail->SMTPSecure = 'tls';                    // ถ้า IT กำหนดให้ใช้
$mail->CharSet    = "UTF-8";

$mail->setFrom('user@company.com', 'ระบบอนุมัติ');
$mail->addAddress('receiver@company.com');
$mail->isHTML(true);
$mail->Subject = "ทดสอบส่งเมล Exchange + Auth";
$mail->Body    = "สวัสดีครับ นี่คือการทดสอบส่งเมลภาษาไทยผ่าน Exchange ✅";
$mail->send();

🔑 ข้อควรรู้
1. ถาม IT ก่อน ว่าจะส่งเมลต้อง login หรือแค่ IP-based relay ก็ได้
2. ถ้าใช้ Port 25 ใน LAN → ส่วนใหญ่ ไม่ต้องใส่ user/pass
3. ถ้าใช้ Port 587 + TLS → มักต้องใส่ user/pass (AD account)
4. Exchange บางที่กำหนด @company.local (internal domain) แทน @company.com


🔹🔹กรณีใช้ Office 365 / Microsoft 365
ตัวอย่างการ config
    $mail->Host       = 'smtp.office365.com';
    $mail->SMTPAuth   = true;
    $mail->Username   = 'your_account@company.com';
    $mail->Password   = 'your_password';  // หรือ App Password ถ้ามี MFA
    $mail->SMTPSecure = 'tls';
    $mail->Port       = 587;

Note: 
ถ้าเป็น Exchange ภายใน (On-Premise) → อาจไม่ต้องใช้ SMTPAuth ถ้าส่งใน network เดียวกัน
    $mail->SMTPAuth = false;


